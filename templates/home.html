{% extends 'base.html' %}
{% load static %}
{% load product_extras %}

{% block meta_description %}Discover fresh, organic farm products including vegetables, fruits, livestock, and agricultural supplies. Quality guaranteed with fast delivery.{% endblock %}


{% block content %}
<!-- Carousel Start -->
    <div class="container-fluid p-0 mb-5 wow fadeIn" data-wow-delay="0.1s">
        <div id="header-carousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img class="w-100" src="{% static 'img/carousel-1.jpg'%}" alt="Image">
                    <div class="carousel-caption">
                        <div class="container">
                            <div class="row justify-content-start">
                                <div class="col-lg-7">
                                    <h1 class="display-2 mb-5 animated slideInDown">Organic Food Is Good For Health</h1>
                                    <a href="{% url 'product_list' %}" class="btn btn-primary rounded-pill py-sm-3 px-sm-5">Products</a>
                                    <a href="#categories" class="btn btn-secondary rounded-pill py-sm-3 px-sm-5 ms-3">Explore Categories</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="carousel-item">
                    <img class="w-100" src="{% static 'img/carousel-2.jpg'%}" alt="Image">
                    <div class="carousel-caption">
                        <div class="container">
                            <div class="row justify-content-start">
                                <div class="col-lg-7">
                                    <h1 class="display-2 mb-5 animated slideInDown">Directly from farm to your table.</h1>
                                    <a href="{%  url 'product_list'%}" class="btn btn-primary rounded-pill py-sm-3 px-sm-5">Products</a>
                                    <a href="" class="btn btn-secondary rounded-pill py-sm-3 px-sm-5 ms-3">Services</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#header-carousel"
                data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#header-carousel"
                data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
    <!-- Carousel End -->
<!-- Featured Products Start  -->
<section class="container-xxl py-4 bg-light">
    <div class="container">
        <div class="text-center mb-4">
            <h2 class="display-6 mb-2">Featured Products</h2>
            <p class="text-muted">Our top-quality handpicked products</p>
        </div>
        <div class="row g-3">
            {% for product in featured_products %}
            <div class="col-xl-3 col-lg-4 col-md-6">
                <div class="product-item card h-100 border-0 shadow-sm">
                    <div class="position-relative product-image-container" style="height: 220px; overflow: hidden;">
                        {% if product.main_image %}
                        <img src="{{ product.main_image.url }}" class="card-img-top w-100 h-100" alt="{{ product.name }}" style="object-fit: cover;">
                        {% else %}
                        <div class="bg-light d-flex align-items-center justify-content-center h-100">
                            <i class="fas fa-image text-muted fs-2"></i>
                        </div>
                        {% endif %}
                        
                        <!-- Product badges - Only show 2 maximum -->
                        {% if product.is_featured %}
                        <span class="badge bg-warning position-absolute top-0 start-0 m-2 px-2 py-1" style="font-size: 0.7rem;">Featured</span>
                        {% endif %}
                        
                        {% if product.discount_percentage %}
                        <span class="badge bg-danger position-absolute top-0 end-0 m-2 px-2 py-1" style="font-size: 0.7rem;">
                            -{{ product.discount_percentage }}%
                        </span>
                        {% elif not product.is_featured and product.is_organic %}
                        <span class="badge bg-success position-absolute top-0 end-0 m-2 px-2 py-1" style="font-size: 0.7rem;">Organic</span>
                        {% endif %}
                    </div>
                    
                    <div class="card-body text-center p-3">
                        <h6 class="card-title mb-2" style="height: 40px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;">
                            <a href="{{ product.get_absolute_url }}" class="text-decoration-none text-dark">
                                {{ product.name }}
                            </a>
                        </h6>
                       
                        <div class="price mb-2">
                            <span class="fw-bold text-success fs-6">KSh {{ product.selling_price }}</span>
                            {% if product.discount_price %}
                            <span class="text-muted text-decoration-line-through ms-1" style="font-size: 0.8rem;">KSh {{ product.price }}</span>
                            {% endif %}
                        </div>
                        
                        {% if product.reviews.count %}
                        <div class="rating mb-2">
                            <div class="rating-stars">
                                {% for i in "12345"|make_list %}
                                <i class="fas fa-star text-warning" style="font-size: 0.7rem;"></i>
                                {% endfor %}
                            </div>
                            <small class="text-muted" style="font-size: 0.7rem;">({{ product.reviews.count }}) Reviews</small>
                        </div>
                        {% endif %}
                    </div>
                    
                    <div class="d-flex border-top">
                        <small class="w-50 text-center border-end py-2">
                            <a class="text-body text-decoration-none" href="{{ product.get_absolute_url }}">
                                 <i class="fa fa-eye text-primary me-1" style="font-size: 0.8rem;"></i>View
                            </a>
                        </small>
                        <small class="w-50 text-center py-2">
                            <a class="text-body text-decoration-none" href="#" onclick="addToCart({{ product.id }})">
                               <i class="fa fa-shopping-bag text-primary me-1" style="font-size: 0.8rem;"></i>Add Cart
                            </a>
                        </small>
                   </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-4">
            <a href="{% url 'product_list' %}?featured=true" class="btn btn-success rounded-pill px-4 py-2">
                View All Products <i class="fas fa-arrow-right ms-1"></i>
            </a>
        </div>
    </div>
</section>
<!-- Featured Products End -->

<!-- About Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="row g-5 align-items-center">
                <div class="col-lg-6 wow fadeIn" data-wow-delay="0.1s">
                    <div class="about-img position-relative overflow-hidden p-5 pe-0">
                        <img class="img-fluid w-100" src="{% static 'img/about.jpg'%}">
                    </div>
                </div>
                <div class="col-lg-6 wow fadeIn" data-wow-delay="0.5s">
                    <h1 class="display-5 mb-4">Premium Organic Fruits & Vegetables</h1>
                    <p class="mb-4">Discover nature's finest selection of organically grown produce, carefully sourced from trusted farmers who share our commitment to sustainable agriculture. Our extensive range ensures you receive only the freshest, most nutritious fruits and vegetables, delivered straight to your doorstep with convenience and care.</p>
                    <p><i class="fa fa-check text-primary me-3"></i>Certified organic produce from verified farms</p>
                    <p><i class="fa fa-check text-primary me-3"></i>Fresh delivery within 24 hours of harvest</p>
                    <p><i class="fa fa-check text-primary me-3"></i>Sustainable farming practices supporting local communities</p>
                    <a class="btn btn-primary rounded-pill py-3 px-5 mt-3" href="">Discover More</a>
                </div>
            </div>
        </div>
    </div>
    <!-- About End -->


    <!-- Feature Start -->
    <div class="container-fluid bg-light bg-icon my-5 py-6">
        <div class="container">
            <div class="section-header text-center mx-auto mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 500px;">
                <h1 class="display-5 mb-3">Why Choose Evergreen</h1>
                <p>Experience the difference with our commitment to quality, sustainability, and exceptional service that sets us apart in the organic marketplace.</p>
            </div>
            <div class="row g-4">
                <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.1s">
                    <div class="bg-white text-center h-100 p-4 p-xl-5">
                        <img class="img-fluid mb-4" src="img/icon-1.png" alt="">
                        <h4 class="mb-3">Natural Growing Process</h4>
                        <p class="mb-4">Our farmers employ time-honoured, natural cultivation methods without harmful pesticides or chemicals, ensuring every product maintains its authentic flavour and nutritional value.</p>
                        <a class="btn btn-outline-primary border-2 py-2 px-4 rounded-pill" href="">Learn More</a>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.3s">
                    <div class="bg-white text-center h-100 p-4 p-xl-5">
                        <img class="img-fluid mb-4" src="img/icon-2.png" alt="">
                        <h4 class="mb-3">Certified Organic Products</h4>
                        <p class="mb-4">All our produce carries official organic certification, guaranteeing that from seed to shelf, every item meets the highest standards of organic agriculture and environmental responsibility.</p>
                        <a class="btn btn-outline-primary border-2 py-2 px-4 rounded-pill" href="">Learn More</a>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.5s">
                    <div class="bg-white text-center h-100 p-4 p-xl-5">
                        <img class="img-fluid mb-4" src="img/icon-3.png" alt="">
                        <h4 class="mb-3">Environmentally Safe</h4>
                        <p class="mb-4">Our sustainable farming practices protect biodiversity, preserve soil health, and reduce environmental impact whilst delivering produce that's safe for you and your family.</p>
                        <a class="btn btn-outline-primary border-2 py-2 px-4 rounded-pill" href="">Learn More</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Feature End -->

<!-- Categories Section Start -->
<section id="categories" class="container-xxl py-4">
    <div class="container">
        <div class="text-center mb-4">
            <h2 class="display-6 mb-2">Shop by Category</h2>
            <p class="text-muted">Explore our wide range of agricultural products</p>
        </div>
        <div class="row g-3">
            {% for category in categories %}
            <div class="col-lg-3 col-md-6">
                <div class="card category-card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-3">
                        {% if category.image %}
                        <img src="{{ category.image.url }}" alt="{{ category.name }}" class="img-fluid mb-2" style="height: 60px; width: 60px; object-fit: cover; border-radius: 50%;">
                        {% else %}
                        <div class="bg-success rounded-circle d-inline-flex align-items-center justify-content-center mb-2" style="height: 60px; width: 60px;">
                            <i class="fas fa-leaf text-white fs-4"></i>
                        </div>
                        {% endif %}
                        <h6 class="card-title mb-1">{{ category.name }}</h6>
                        <p class="card-text text-muted" style="font-size: 0.8rem;">{{ category.product_count }} products</p>
                        <a href="{% url 'category_products' category.slug %}" class="btn btn-outline-success btn-sm rounded-pill px-3">
                            Explore <i class="fas fa-arrow-right ms-1" style="font-size: 0.7rem;"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<!-- Categories Section End -->

<!-- Product Tabs Start -->
<section class="container-xxl py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 mb-3">Our Products</h2>
            <p class="lead text-muted">Fresh products categorized for your convenience</p>
        </div>
        
        <!-- Nav tabs -->
        <ul class="nav nav-pills justify-content-center mb-5" id="productTabs">
            <li class="nav-item me-2">
                <button class="btn btn-outline-success active" data-bs-toggle="pill" data-bs-target="#vegetables" type="button">
                    <i class="fas fa-carrot me-2"></i>Vegetables
                </button>
            </li>
            <li class="nav-item me-2">
                <button class="btn btn-outline-success" data-bs-toggle="pill" data-bs-target="#fruits" type="button">
                    <i class="fas fa-apple-alt me-2"></i>Fruits
                </button>
            </li>
            <li class="nav-item me-2">
                <button class="btn btn-outline-success" data-bs-toggle="pill" data-bs-target="#newArrivals" type="button">
                    <i class="fas fa-star me-2"></i>New Arrivals
                </button>
            </li>
            <li class="nav-item">
                <button class="btn btn-outline-success" data-bs-toggle="pill" data-bs-target="#organic" type="button">
                    <i class="fas fa-leaf me-2"></i>Organic
                </button>
            </li>
        </ul>
        
        <!-- Tab content -->
        <div class="tab-content" id="productTabContent">
            <!-- Vegetables Tab -->
            <div class="tab-pane fade show active" id="vegetables">
                <div class="row g-4">
                    {% for product in vegetables %}
                    <div class="col-xl-3 col-lg-4 col-md-6">
                        {% include 'product_card.html' %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            
            <!-- Fruits Tab -->
            <div class="tab-pane fade" id="fruits">
                <div class="row g-4">
                    {% for product in fruits %}
                    <div class="col-xl-3 col-lg-4 col-md-6">
                        {% include 'product_card.html' %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            
            <!-- New Arrivals Tab -->
            <div class="tab-pane fade" id="newArrivals">
                <div class="row g-4">
                    {% for product in new_products %}
                    <div class="col-xl-3 col-lg-4 col-md-6">
                        {% include 'product_card.html' %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            
            <!-- Organic Tab -->
            <div class="tab-pane fade" id="organic">
                <div class="row g-4">
                    {% for product in organic_products %}
                    <div class="col-xl-3 col-lg-4 col-md-6">
                        {% include 'product_card.html' %}
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <div class="text-center mt-5">
            <a href="{% url 'product_list' %}" class="btn btn-success btn-lg rounded-pill px-5">
                Browse All Products <i class="fas fa-arrow-right ms-2"></i>
            </a>
        </div>
    </div>
</section>
<!-- Product Tabs End -->

<!-- Why Choose Us Start -->
<section class="container-fluid bg-light py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 mb-3">Why Choose Us</h2>
            <p class="lead text-muted">Quality, freshness, and reliability guaranteed</p>
        </div>
        <div class="row g-4">
            <div class="col-lg-3 col-md-6">
                <div class="text-center p-4">
                    <div class="bg-success rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="height: 80px; width: 80px;">
                        <i class="fas fa-leaf text-white fs-2"></i>
                    </div>
                    <h5>100% Organic</h5>
                    <p class="text-muted">All our products are naturally grown without harmful chemicals.</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="text-center p-4">
                    <div class="bg-success rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="height: 80px; width: 80px;">
                        <i class="fas fa-truck text-white fs-2"></i>
                    </div>
                    <h5>Fast Delivery</h5>
                    <p class="text-muted">Quick and reliable delivery to your doorstep across Kenya.</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="text-center p-4">
                    <div class="bg-success rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="height: 80px; width: 80px;">
                        <i class="fas fa-shield-alt text-white fs-2"></i>
                    </div>
                    <h5>Quality Assured</h5>
                    <p class="text-muted">Every product undergoes quality checks before delivery.</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="text-center p-4">
                    <div class="bg-success rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="height: 80px; width: 80px;">
                        <i class="fab fa-whatsapp text-white fs-2"></i>
                    </div>
                    <h5>Easy Ordering</h5>
                    <p class="text-muted">Simple WhatsApp ordering system for your convenience.</p>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Why Choose Us End -->

<!-- Newsletter Start -->
<section class="container-xxl py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-12 text-center">
                <div class="bg-success rounded-3 p-5 text-white">
                    <h3 class="mb-3">Stay Updated!</h3>
                    <p class="mb-4">Subscribe to get notifications about new products and special offers.</p>
                    <form class="row g-3 justify-content-center">
                        <div class="col-md-6">
                            <input type="email" class="form-control form-control-lg" placeholder="Enter your email">
                        </div>
                        <div class="col-auto">
                            <button type="submit" class="btn btn-light btn-lg px-4">
                                <i class="fas fa-bell me-2"></i>Subscribe
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Newsletter End -->
{% endblock %}

{% block extra_js %}
<script>
// WhatsApp ordering function
function orderViaWhatsApp(productName, price) {
    const message = `Hi! I'm interested in ordering: ${productName} (KSh ${price})`;
    const whatsappNumber = '+254700000000'; // Replace with your WhatsApp number
    const encodedMessage = encodeURIComponent(message);
    const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
    window.open(whatsappURL, '_blank');
}

// Smooth scrolling for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// Auto-advance carousel
const heroCarousel = document.getElementById('heroCarousel');
if (heroCarousel) {
    const carousel = new bootstrap.Carousel(heroCarousel, {
        interval: 5000,
        wrap: true
    });
}

{% endblock %}